<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <style>
      .active {
        color: red;
      }
      .title {
        background-color: blueviolet;
      }
      #nav {
        position: fixed;
        right: 20px;
      }
    </style>
  </head>
  <body>
    <ul id="nav">
    </ul>
    <h1 class="title" id="1">1111</h1>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <h1 class="title" id="2">2222</h1>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>

    <h1 class="title" id="3">3333</h1>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
    <p>jasdfjkahsdf ahsfhalfhdlj asdkfjhasd</p>
  </body>
  <script>
    function generateNavigation() {
      let titles = document.getElementsByClassName("title");
      let nav = document.getElementById("nav");
      let toffset = [];
      nav.innerHTML = '';
      for (let i = 0; i < titles.length; i++) {
        let title = titles[i];
        if (!title.id) {
          title.id = 'auto-section-' + (i + 1);
        }
        let li = document.createElement("li");
        let a = document.createElement("a");
        a.href = "#" + title.id;
        a.textContent = title.textContent;
        a.setAttribute('data-index', i);
        if (i === 0) {
          a.className = "active";
        }
        a.addEventListener('click', function(e) {
          e.preventDefault();
          let targetId = this.getAttribute('href').substring(1);
          let targetElement = document.getElementById(targetId);
          if (targetElement) {
            targetElement.scrollIntoView({
              behavior: 'smooth',
              block: 'start'
            });
          }
        });
        li.appendChild(a);
        nav.appendChild(li);
        toffset.push(title.offsetTop);
      }
      return { titles, toffset };
    }
    function updateActiveNav(toffset) {
      let navLinks = document.querySelectorAll("#nav a");
      document.addEventListener('scroll', function() {
        let scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
        for (let i = toffset.length - 1; i >= 0; i--) {
          if (toffset[i] <= scrollTop + 100) {
            navLinks.forEach(link => link.classList.remove('active'));
            if (navLinks[i]) {
              navLinks[i].classList.add('active');
            }
            break;
          }
        }
      });
    }
    document.addEventListener('DOMContentLoaded', function() {
      let { titles, toffset } = generateNavigation();
      updateActiveNav(toffset);
      console.log('自动生成了', titles.length, '个导航项');
      console.log('标题位置偏移:', toffset);
    });
  </script>
</html>
